"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Style=exports.getCss=exports.css=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _react=require("react");var _reactDom=require("react-dom");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var r=function(e){return e}(new Map),i=function i(){return Array.from(r.entries()).reduce(function(e,_ref){var _ref2=_slicedToArray(_ref,2),t=_ref2[0],n=_ref2[1];return Object.assign({},e,_defineProperty({},t,Array.from(n.values()).map(function(_ref3){var e=_ref3.rule;return e}).join("")))},{})},a=function(e){return{pub:function pub(t){return e.map(function(e){return e(t)})},sub:function sub(t){var n=e.push(t)-1;return function(){return delete e[n]}}}}([]),o=function o(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";return r.has(e)||r.set(e,new Map),function(t){var _ref4=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},n=_ref4.id,o=_ref4.rule;return r.get(e).has(t)||void 0===n||(r.get(e).set(t,{id:n,key:t,media:e,rule:o}),a.pub(i())),r.get(e).get(t)}};var s=function(){var e=parseInt("ad",36),t=parseInt("zz",36),n=parseInt("aaa",36),r=parseInt("zzz",36);var i=e;return function(e){if(e){var _t=parseInt(e,36);return i=Math.max(i,_t),_t.toString(36)}if((i+=i<t||i>=n?1:n-t)>r)throw new RangeError;return i.toString(36)}}();var c=function c(e){return e.replace(/[A-Z]/g,"-$&").toLowerCase().replace(/^ms-/,"-ms-")},l=function l(e){return Object.entries(e).reduce(function(e,_ref5){var _ref6=_slicedToArray(_ref5,2),t=_ref6[0],n=_ref6[1];switch(!0){case/^(number|string)$/.test(typeof n==="undefined"?"undefined":_typeof(n)):return e.concat(c(t)+":"+n);default:throw new TypeError}},[]).join(";")};var u=function u(e){return e.match(/(?:((?:element|isolate-override|plaintext))|((?:calc|cross-fade|filter|grab(?:bing)?|image-set|sticky|zoom-(?:in|out)))|((?:fill(?:-available)?|fit-content|isolate|(?:max|min)-content|stretch))|((?:pixelated)))/)};var d=function d(e){return e.replace(/[A-Z]/g,"-$&").toLowerCase()};var p=function p(e){return Object.entries(e).reduce(function(e,_ref7){var _ref8=_slicedToArray(_ref7,2),t=_ref8[0],n=_ref8[1];if("string"==typeof n)if(u(n)){var _r=u(n).slice(1,5).filter(Boolean)[0];e[t]=function(e){return[["Moz"],["Webkit"],["Webkit","Moz"],["Webkit","Moz","O"]][u(_r).slice(1,5).findIndex(function(e){return e})]}().map(function(e){return n.replace(_r,d(e)+"-"+d(_r)).trim()}).concat(n)}else e[t]=n;return e},e)},m=function m(e){return[function(e){var t=new Map([["alignItems","WebkitBoxAlign"],["flexGrow","WebkitBoxFlex"],["flexWrap","WebkitBoxLines"],["justifyContent","WebkitBoxPack"]]),n=new Map([["flex",["-webkit-box","-webkit-flex","flex"]],["flex-end","end"],["flex-start","start"],["inline-flex",["-webkit-inline-box","-webkit-inline-flex","inline-flex"]],["nowrap","single"],["space-around","justify"],["space-between","justify"],["wrap","multiple"],["wrap-reverse","multiple"]]);return Object.entries(e).reduce(function(e,_ref9){var _ref10=_slicedToArray(_ref9,2),r=_ref10[0],i=_ref10[1];return"display"===r&&n.has(i)&&(e.display=n.get(i)),"flexDirection"===r&&"string"==typeof i&&(e.WebkitBoxDirection=i.match(/reverse/)?"reverse":"normal",e.WebkitBoxOrient=i.match(/column/)?"vertical":"horizontal"),t.has(r)&&(e[t.get(r)]=n.get(i)||i),e},e)},function(e){var t=["-webkit-",""],n=/((?:repeating-)?(?:linear|radial)-gradient)/gi;return Object.entries(e).reduce(function(e,_ref11){var _ref12=_slicedToArray(_ref11,2),r=_ref12[0],i=_ref12[1];return"string"==typeof i&&i.match(n)&&(e[r]=t.map(function(e){return i.replace(n,function(t){return e+t})})),e},e)},function(e){return Object.entries(e).reduce(function(e,_ref13){var _ref14=_slicedToArray(_ref13,2),t=_ref14[0],n=_ref14[1];return function(e){var t=function(e){return e.match(/(?:((?:boxSizing|textAlignLast))|((?:tabSize))|((?:imageRendering|overscrollBehavior|textSpacing))|((?:object(?:Fit|Position)))|((?:align(?:Content|Items|Self)|animation(?:Delay|Direction|Duration|FillMode|IterationCount|Name|PlayState|TimingFunction)?|back(?:dropFilter|faceVisibility|groundClip)|borderBlock(?:End|Start)|boxDecorationBreak|break(?:After|Before|Inside)|clipPath|colorAdjust|filter|flex(?:Basis|Direction|Flow|Grow|Shrink|Wrap)?|fontKerning|justifyContent|marginBlock(?:End|Start)|mask(?:Border(?:Outset|Repeat|Slice|Source|Width)?(?:Clip|Composite|Image|Origin|Position|Repeat|Size)?)?|order|paddingBlock(?:End|Start)|perspective(?:Origin)?|shape(?:ImageThreshold|Margin|Outside)|text(?:DecorationSkip|Emphasis(?:Color|Position|Style))|transform(?:Origin|Style)?|transition(?:Delay|Duration|Property|TimingFunction)?))|((?:appearance|border(?:Inline(?:End|Start))|column(?:s|Count|Fill|Gap|Rule(?:Color|Style|Width)?|Span|Width)|font(?:FeatureSettings|LanguageOverride|VariantLigatures)|marginInline(?:End|Start)|padding(?:Inline(?:End|Start))|textDecoration(?:Color|Line|Style)?))|((?:hyphens|textSizeAdjust|userSelect))|((?:flow(?:From|Into)|regionFragment|scrollSnap(?:Coordinate|Destination|Points(?:X|Y)|Type)|writingMode))|((?:borderImage)))/)}(e);return t?[["Moz"],["Moz","O"],["Ms"],["O"],["Webkit"],["Webkit","Moz"],["Webkit","Moz","Ms"],["Webkit","Ms"],["Webkit","O"]][t.slice(1,10).findIndex(function(e){return e})]:[]}(t).forEach(function(r){e[r+function(e){return e.charAt(0).toUpperCase()+e.slice(1)}(t)]=n}),e},e)},function(e){return Object.entries(e).reduce(function(e,_ref15){var _ref16=_slicedToArray(_ref15,2),t=_ref16[0],n=_ref16[1];var r=t.replace(/[A-Z]/g,"-$&").toLowerCase();return e[r]=n,r!==t&&delete e[t],e},e)},p].reduce(function(e,t){return t(e)},e)},f=function f(e,t){return Object.entries(m(_defineProperty({},e,t))).reduce(function(e,_ref17){var _ref18=_slicedToArray(_ref17,2),t=_ref18[0],n=_ref18[1];switch(!0){case Array.isArray(n):n.forEach(function(n){var r=c(t)+":"+n;e.includes(r)||e.splice(-1,0,r)});break;case/^(number|string)$/.test(typeof n==="undefined"?"undefined":_typeof(n)):{var _r2=c(t)+":"+n;e.includes(_r2)||e.splice(-1,0,_r2);break}}return e},[c(e)+":"+t]).join(";")};var g=function g(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"";return Object.entries(e).reduce(function(e,_ref19){var _ref20=_slicedToArray(_ref19,2),a=_ref20[0],c=_ref20[1];if("object"!=(typeof c==="undefined"?"undefined":_typeof(c))){var _l=f(a,c);return e.concat(function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"";var a=""+i+n+e;if(o(t),!r.get(t).has(a)){var _r3=""+i+s(),_c=/^[*a-z]/.test(n)?n+"{"+e+"}":"."+_r3+n+"{"+e+"}";o(t)(a,{id:_r3,rule:_c})}return r.get(t).get(a)}(_l,t,n,i).id)}switch(!0){case/(?:(\$[^:[ +>~{]+)?([\][*:_a-z]+)?)([ +>~])/.test(a):return function(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"";var a=Array.from(/(?:(\$[^:[ +>~]+)?([[\]*:=_a-z-]+)?)([ +>~])(?:(\$[^:[]+)?(.+)?)/.exec(e)),_a=_slicedToArray(a,6),c=_a[1],_a$=_a[2],u=_a$===undefined?"":_a$,d=_a[3],p=_a[4],_a$2=_a[5],m=_a$2===undefined?"":_a$2,f=l(t),g=""+i+u+c,h=""+i+m+p;o(n);var b="",$="";void 0!==c&&(b=r.get(n).has(g)?r.get(n).get(g).id:o(n)(g,{id:""+i+s()}).id),void 0!==p&&($=r.get(n).has(h)?r.get(n).get(h).id:o(n)(h,{id:""+i+s()}).id);var y=[].concat(i,u,d,i,m,f).join(""),x=a.slice(1,6),w=[void 0===c?"":"."+b,u,d,void 0===p?"":"."+$,m,"{",f,"}"].join("");o(n)(y,{id:x,rule:w})}(a,c,t,i),e;case/^\$/.test(a):return e.concat(function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"";var a=""+i+n+e;if(o(t),!r.get(t).has(a)){var _e=""+i+s();o(t)(a,{id:_e})}return r.get(t).get(a)}(a,t,n,i).id);case/^@media/.test(a):return e.concat(g(c,a.substr(7),n,i));case/^[[*:a-z]/.test(a)&&"object"==(typeof c==="undefined"?"undefined":_typeof(c)):return e.concat(g(c,t,""+n+a,i))}},[]).join(" ")},h=function h(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";if("string"==typeof e)return e;if(Array.isArray(e))return e.map(function(e){return h(e)}).join();{var _n=l(e);if(o(),!r.get("").has(_n)){var _e2=""+t+s(),_r4="@font-face{font-family:"+_e2+";"+_n+"}";o()(_n,{id:_e2,rule:_r4})}return r.get("").get(_n).id}};var b=function b(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var n=function(e){return Object.entries(e).reduce(function(e,_ref21){var _ref22=_slicedToArray(_ref21,2),t=_ref22[0],n=_ref22[1];return e.concat(t+"{"+l(n)+"}")},[]).join("")}(e);if(o(),!r.get("").has(n)){var _e3=""+t+s(),_r5="@keyframes "+_e3+"{"+n+"}";o()(n,{id:_e3,rule:_r5})}return r.get("").get(n)};var $=function $(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";return Object.entries(e).reduce(function(e,_ref23){var _ref24=_slicedToArray(_ref23,2),n=_ref24[0],r=_ref24[1];return"fontFamily"===n&&"string"!=typeof r?e.fontFamily=h(r,t):"animationName"===n&&"string"!=typeof r?e.animationName=b(r,t).id:"object"==(typeof r==="undefined"?"undefined":_typeof(r))&&null!==r&&$(r,t),e},e)};var y=function y(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";return g($(e,t),"","",t)},x=function x(e){var t=[/@font-face\{font-family:([^;]+)()?()?()?()?;([^}]*?)\}/,/@keyframes ([^{]+)()?()?()?()?\{((?:[^{]+\{[^}]*\})*?)\}/,/(?:\.([^:{]+)(:[^ +>{~]+)?)([ +>~])?(?:\.([^:{]+)(:[^{]+)?)?{([^}]*)}/];return Array.from(e).map(function(e){var n=e.media;var r=e.textContent;return t.reduce(function(e,t){for(;t.exec(r);){var _i=Array.from(t.exec(r)),_a2=_i[3]?[].concat(_i[2],_i[3],_i[5],_i[6]).join(""):[].concat(_i[2],_i[6]).join(""),_c2=_i[3]?_i.slice(1,6):s(_i[1]),_l2=_i[0];e.push(o(n)(_a2,{id:_c2,rule:_l2})),r=r.replace(t,"")}return e},[])})};var Style=function(_t2){_inherits(Style,_t2);function Style(e){var _this;_classCallCheck(this,Style);_this=_possibleConstructorReturn(this,(Style.__proto__||Object.getPrototypeOf(Style)).call(this,e)),_this,_this.canUseDOM=Boolean("undefined"!=typeof window&&window.document&&window.document.createElement),_this.canUseDOM&&(_this.nodes=document.head.querySelectorAll("style.rehydrate"),x(_this.nodes),window.css=y),_this.state={value:i()},_this._hasUnmounted=!1,_this.unsub=function(){return null};return _this}_createClass(Style,[{key:"componentDidMount",value:function componentDidMount(){this.nodes.forEach(function(e){return e.remove()}),this.subscribe()}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.unsub(),this._hasUnmounted=!0}},{key:"subscribe",value:function subscribe(){var _this2=this;this.unsub=a.sub(function(e){_this2._hasUnmounted||_this2.setState(function(t){return e===t.value?null:{value:e}})});var e=i();e!==this.state.value&&this.setState({value:e})}},{key:"render",value:function render(){var t=this.props.render,r=this.state.value,i=Object.entries(r).map(function(_ref25){var _ref26=_slicedToArray(_ref25,2),t=_ref26[0],n=_ref26[1];return(0,_react.createElement)("style",{className:"rehydrate",dangerouslySetInnerHTML:{__html:"/*<![CDATA[*/"+n+"/*]]>*/"},key:t||"",media:t||null})});switch(!0){case this.canUseDOM:return(0,_reactDom.createPortal)(i,document.head);case t:return i;default:return null}}}]);return Style}(_react.PureComponent);exports.css=y;exports.getCss=i;exports.Style=Style;